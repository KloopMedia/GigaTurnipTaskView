(this["webpackJsonpgigaturnip-taskview"]=this["webpackJsonpgigaturnip-taskview"]||[]).push([[0],{266:function(e,t,n){},473:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(21),r=n.n(i),s=(n(266),n(154)),o=n.n(s),l=n(230),j=n(18),d=n(248),u=n(24),b=n(242),h="api/v1/campaigns/",p="api/v1/tasks/",O=n.n(b).a.create({baseURL:"https://journal-bb5e3.uc.r.appspot.com/"});O.interceptors.request.use((function(e){var t=localStorage.getItem("token");return t&&(e.headers.Authorization="JWT "+t),e}),(function(e){return Promise.reject(e)}));var m=O,g=(n(460),n(5)),x=function(e){var t=e.schema,n=e.disabled;return Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{className:"form-label",children:null===t||void 0===t?void 0:t.title}),Object(g.jsx)("br",{}),Object(g.jsx)("input",{disabled:n,type:"file"})]})},f=n(115),v=function(){var e=Object(u.g)().id,t=Object(u.f)(),n=Object(a.useState)({}),c=Object(j.a)(n,2),i=c[0],r=c[1],s=Object(a.useState)({}),b=Object(j.a)(s,2),h=b[0],O=b[1],v=Object(a.useState)({}),w=Object(j.a)(v,2),S=w[0],C=w[1],k=Object(a.useState)(!1),I=Object(j.a)(k,2),y=I[0],N=I[1],B={customfile:x};Object(a.useEffect)((function(){e&&function(){var t=Object(l.a)(o.a.mark((function t(){var n,a,c,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.get(p+e+"/").then((function(e){return e.data}));case 2:n=t.sent,a=n.stage,console.log(n,a),c=JSON.parse(a.json_schema),i=JSON.parse(a.ui_schema),C(n.responses),r(c),O(i),N(n.complete);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[e]);return Object(g.jsx)("div",{style:{width:"70%",minWidth:"400px",margin:"0 auto",display:"block",padding:10},children:Object(g.jsx)(d.a,{schema:i,uiSchema:h,formData:S,widgets:B,disabled:y,onChange:function(e){C(e.formData)},onSubmit:function(){console.log(S);var n={responses:S,complete:!0};m.patch(p+e+"/",n).then((function(){return alert("Saved")})).then((function(){return t.goBack()}))},children:Object(g.jsx)(f.a,{type:"submit",disabled:y,children:"Submit"})})})},w=n(43),S=n(15),C=n(7),k=n(506),I=n(530),y=n(31),N=n(518),B=n(246),T=n.n(B),z=n(245),E=n.n(z),U=n(247),P=n.n(U),A=n(244),G=n.n(A),L=n(508),_=n(510),J=n(511),W=n(512),D=n(116),R=n(513),F=n(514),M=n(525),X=n(516),q=n(517),K=n(529),H=n(515),Q=n(476),V=n(519),Y=n(520),Z=n(64);Z.a.initializeApp({apiKey:"AIzaSyCXiwOUNsbzKH7sbSAZrqA9f7VOeCMdUOQ",authDomain:"gigaturnip-b6b5b.firebaseapp.com",projectId:"gigaturnip-b6b5b",storageBucket:"gigaturnip-b6b5b.appspot.com",messagingSenderId:"414429242328",appId:"1:414429242328:web:a4685f5ac6895ea767c8ad",measurementId:"G-Y8JTEJMTET"});var $=new Z.a.auth.GoogleAuthProvider;Z.a.firestore().settings({ignoreUndefinedProperties:!0});var ee=function(){return $.setCustomParameters({prompt:"select_account"}),Z.a.auth().signInWithPopup($)},te=function(){return Z.a.auth().signOut().then((function(){return localStorage.removeItem("token")})).then((function(){return window.location.reload(!1)}))},ne=Z.a,ae=c.a.createContext(),ce=function(e){var t=e.children,n=Object(a.useState)(null),c=Object(j.a)(n,2),i=c[0],r=c[1];return Object(a.useEffect)((function(){ne.auth().onAuthStateChanged((function(e){e&&(r(e),e.getIdToken(!0).then((function(e){localStorage.setItem("token",e)})))})),ne.auth().onIdTokenChanged((function(e){e&&e.getIdToken(!1).then((function(e){localStorage.setItem("token",e)}))}))}),[]),Object(g.jsx)(ae.Provider,{value:{currentUser:i},children:t})},ie="GigaTurnip Tasks",re=240,se=Object(k.a)((function(e){return Object(I.a)({root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:re,width:"calc(100% - ".concat(re,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:re,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:re,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(S.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},e.breakpoints.up("sm"),{width:e.spacing(9)+1}),toolbar:Object(w.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),content:{flexGrow:1},title:{flexGrow:1},formControl:{margin:e.spacing(1),alignItems:"center"},selectEmpty:{marginTop:e.spacing(2)},select:{},selectIcon:{fill:"white",top:"calc(50% - 14px)"}})})),oe=function(e){var t,n,c=se(),i=Object(y.a)(),r=Object(u.f)(),s=Object(u.g)().campaignId,o=Object(a.useContext)(ae).currentUser,l=e.children,d=Object(a.useState)(!1),b=Object(j.a)(d,2),p=b[0],O=b[1],x=Object(a.useState)(s),f=Object(j.a)(x,2),v=f[0],w=f[1],k=Object(a.useState)([]),I=Object(j.a)(k,2),B=I[0],z=I[1];console.log("CURRENT CAMPAIGN",s),Object(a.useEffect)((function(){m.get(h).then((function(e){return e.data})).then((function(e){console.log(e),z(e)}))}),[]);return Object(g.jsxs)("div",{className:c.root,children:[Object(g.jsx)(L.a,{}),Object(g.jsx)(_.a,{position:"fixed",className:Object(C.a)(c.appBar,Object(S.a)({},c.appBarShift,p)),children:Object(g.jsxs)(J.a,{children:[Object(g.jsx)(W.a,{color:"inherit","aria-label":"open drawer",onClick:function(){O(!0)},edge:"start",className:Object(C.a)(c.menuButton,Object(S.a)({},c.hide,p)),children:Object(g.jsx)(G.a,{})}),Object(g.jsx)(D.a,{variant:"h6",noWrap:!0,style:{cursor:"pointer"},onClick:function(){r.push("/")},children:ie}),Object(g.jsx)(R.a,{className:c.title}),Object(g.jsx)(F.a,{className:c.formControl,size:"small",children:Object(g.jsx)(M.a,{className:c.select,autoWidth:!0,labelId:"campaign-select-label",id:"campaign-select-label",value:v,onChange:function(e){var t=e.target.value;console.log(t),w(t),r.push("/campaign/".concat(t))},label:"Campaign",disableUnderline:!0,style:{color:"white"},inputProps:{classes:{icon:c.selectIcon}},children:B.map((function(e){return Object(g.jsx)(X.a,{value:e.id,children:e.name},"".concat(e.name,"_").concat(e.id))}))})}),o?Object(g.jsx)(q.a,{onClick:te,color:"inherit",children:"Log out"}):Object(g.jsx)(q.a,{onClick:ee,color:"inherit",children:"Login"})]})}),Object(g.jsxs)(K.a,{variant:"permanent",className:Object(C.a)(c.drawer,(t={},Object(S.a)(t,c.drawerOpen,p),Object(S.a)(t,c.drawerClose,!p),t)),classes:{paper:Object(C.a)((n={},Object(S.a)(n,c.drawerOpen,p),Object(S.a)(n,c.drawerClose,!p),n))},children:[Object(g.jsx)("div",{className:c.toolbar,children:Object(g.jsx)(W.a,{onClick:function(){O(!1)},children:"rtl"===i.direction?Object(g.jsx)(E.a,{}):Object(g.jsx)(T.a,{})})}),Object(g.jsx)(N.a,{}),Object(g.jsx)(H.a,{children:Object(g.jsxs)(Q.a,{button:!0,onClick:function(){return e="chain",void r.push("/campaign/".concat(s,"/").concat(e));var e},children:[Object(g.jsx)(V.a,{children:Object(g.jsx)(P.a,{})}),Object(g.jsx)(Y.a,{primary:"Chains"})]})})]}),Object(g.jsxs)("main",{className:c.content,children:[Object(g.jsx)("div",{className:c.toolbar}),l]})]})},le=n(59),je=240,de=Object(k.a)((function(e){return Object(I.a)({root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:je,width:"calc(100% - ".concat(je,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:je,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:je,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(S.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},e.breakpoints.up("sm"),{width:e.spacing(9)+1}),toolbar:Object(w.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),content:{flexGrow:1},title:{flexGrow:1}})})),ue=function(e){var t=de(),n=(Object(y.a)(),c.a.useState(!1)),i=Object(j.a)(n,2),r=i[0],s=(i[1],e.children),o=Object(a.useContext)(ae).currentUser;Object(u.f)();return Object(g.jsxs)("div",{className:t.root,children:[Object(g.jsx)(L.a,{}),Object(g.jsx)(_.a,{position:"fixed",className:Object(C.a)(t.appBar,Object(S.a)({},t.appBarShift,r)),children:Object(g.jsxs)(J.a,{children:[Object(g.jsx)(D.a,{className:t.title,variant:"h6",noWrap:!0,children:ie}),o?Object(g.jsx)(q.a,{onClick:te,color:"inherit",children:"Log out"}):Object(g.jsx)(q.a,{onClick:ee,color:"inherit",children:"Login"})]})}),Object(g.jsxs)("main",{className:t.content,children:[Object(g.jsx)("div",{className:t.toolbar}),s]})]})},be=n(521),he=n(523),pe=n(522),Oe=Object(k.a)({root:{width:300},extra:{marginBottom:15}}),me=function(e){var t=Oe(),n=e.chain,a=n.id,c=n.name,i=n.description,r=Object(u.f)();return Object(g.jsxs)(be.a,{className:t.root,children:[Object(g.jsxs)(pe.a,{children:[Object(g.jsx)(D.a,{variant:"h5",component:"h2",gutterBottom:!0,children:c}),Object(g.jsxs)(D.a,{className:t.extra,variant:"subtitle2",color:"textSecondary",children:["ID: ",a]}),Object(g.jsx)(D.a,{variant:"body1",component:"p",children:i||Object(g.jsx)("br",{})})]}),Object(g.jsx)(he.a,{children:Object(g.jsx)(q.a,{size:"small",onClick:function(){r.push("/campaign/".concat(a,"/tasks"))},children:"Open"})})]})},ge=function(){var e=Object(a.useState)([]),t=Object(j.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){m.get(h).then((function(e){return e.data})).then((function(e){console.log(e),c(e)}))}),[]),Object(g.jsx)(R.a,{container:!0,justify:"center",children:n.map((function(e){return Object(g.jsx)(R.a,{item:!0,style:{padding:10},children:Object(g.jsx)(me,{chain:e},e.id)})}))})},xe=n(6),fe=n(526),ve=["children","value","index"],we=function(e){var t=e.children,n=e.value,a=e.index,c=Object(xe.a)(e,ve);return Object(g.jsx)("div",Object(w.a)(Object(w.a)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},c),{},{children:n===a&&Object(g.jsx)(fe.a,{p:3,children:Object(g.jsx)(D.a,{children:t})})}))},Se=n(527),Ce=n(524);function ke(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var Ie=Object(k.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper}}})),ye=function(e){var t=Ie(),n=e.value,a=e.handleChange;return Object(g.jsxs)(R.a,{children:[Object(g.jsx)("div",{className:t.root,children:Object(g.jsxs)(Se.a,{value:n,onChange:a,variant:"fullWidth",centered:!0,"aria-label":"simple tabs example",children:[Object(g.jsx)(Ce.a,Object(w.a)({label:"\u041d\u0435\u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435"},ke(0))),Object(g.jsx)(Ce.a,Object(w.a)({label:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435"},ke(1)))]})}),e.children]})},Ne=Object(k.a)({root:{width:300},extra:{marginBottom:15}}),Be=function(e){var t=Ne(),n=e.id,a=(e.complete,e.name),c=e.description,i=e.creatable,r=Object(u.f)();return Object(g.jsxs)(be.a,{className:t.root,children:[Object(g.jsxs)(pe.a,{children:[Object(g.jsx)(D.a,{variant:"h5",component:"h2",gutterBottom:!0,children:a}),Object(g.jsx)(D.a,{variant:"body1",component:"p",children:c||Object(g.jsx)("br",{})})]}),Object(g.jsx)(he.a,{children:i?Object(g.jsx)(q.a,{size:"small",onClick:function(){var e={stage:n};m.post(p,e).then((function(e){return e.data})).then((function(e){return r.push("".concat(r.location.pathname,"/").concat(e.id))}))},children:"Create"}):Object(g.jsx)(q.a,{size:"small",onClick:function(){r.push("".concat(r.location.pathname,"/").concat(n))},children:"Open"})})]})},Te=function(e){e.stage;var t=e.assignee,n=e.complete,c=e.username,i=Object(a.useState)([]),r=Object(j.a)(i,2),s=r[0],o=r[1];return Object(a.useEffect)((function(){console.log("stage=&assignee=".concat(t,"&complete=").concat(n,"&assignee__username=").concat(c)),m.get("".concat(p,"?stage=&assignee=&complete=").concat(n,"&assignee__username=").concat(c)).then((function(e){return e.data})).then((function(e){return o(e)}))}),[]),Object(g.jsx)(R.a,{container:!0,direction:"column",alignItems:"center",justify:"center",children:s.map((function(e){return Object(g.jsx)(R.a,{item:!0,style:{padding:12},children:Object(g.jsx)(Be,{id:e.id,name:e.stage.name,description:e.stage.description,complete:e.complete})},e.id)}))})},ze=function(e){e.stage,e.assignee,e.complete,e.username;var t=Object(a.useState)([]),n=Object(j.a)(t,2),c=n[0],i=n[1];return Object(a.useEffect)((function(){m.get("api/v1/taskstages/user_relevant/").then((function(e){return e.data})).then((function(e){i(e),console.log(e)}))}),[]),Object(g.jsx)(R.a,{container:!0,children:c.map((function(e){return Object(g.jsx)(R.a,{item:!0,style:{padding:12},children:Object(g.jsx)(Be,{id:e.id,name:e.name,description:e.description,complete:!1,creatable:!0})},e.id)}))})},Ee=function(e){var t=Object(a.useContext)(ae).currentUser,n=Object(a.useState)(0),c=Object(j.a)(n,2),i=c[0],r=c[1];return t&&t.uid&&Object(g.jsxs)(R.a,{children:[Object(g.jsx)(ze,{username:t.uid,complete:!1}),Object(g.jsxs)(ye,{value:i,handleChange:function(e,t){r(t)},children:[Object(g.jsx)(we,{value:i,index:0,children:Object(g.jsx)(Te,{username:t.uid,complete:!1})}),Object(g.jsx)(we,{value:i,index:1,children:Object(g.jsx)(Te,{username:t.uid,complete:!0})})]})]})},Ue=function(){Object(a.useContext)(ae).currentUser;return Object(g.jsx)("div",{children:Object(g.jsx)(le.a,{children:Object(g.jsxs)(u.c,{children:[Object(g.jsx)(u.a,{path:"/campaign/:campaignId",children:Object(g.jsxs)(oe,{children:[Object(g.jsx)(u.a,{exact:!0,path:"/campaign/:campaignId/tasks",children:Object(g.jsx)(Ee,{})}),Object(g.jsx)(u.a,{exact:!0,path:"/campaign/:campaignId/tasks/:id",children:Object(g.jsx)(v,{})})]})}),Object(g.jsx)(u.a,{path:"/",children:Object(g.jsx)(ue,{children:Object(g.jsx)(ge,{})})})]})})})},Pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,533)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),i(e),r(e)}))};r.a.render(Object(g.jsx)(ce,{children:Object(g.jsx)(Ue,{})}),document.getElementById("root")),Pe()}},[[473,1,2]]]);
//# sourceMappingURL=main.c9c761e9.chunk.js.map
(this["webpackJsonpgigaturnip-taskview"]=this["webpackJsonpgigaturnip-taskview"]||[]).push([[0],{314:function(e,t,n){},522:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(75),i=n.n(r),o=(n(314),n(39)),s=n(26),u=n(2),l=n.n(u),d=n(6),j=n(7),b=n(262),h=n(77),f=n(43),O=Object(b.a)({apiKey:"AIzaSyCXiwOUNsbzKH7sbSAZrqA9f7VOeCMdUOQ",authDomain:"gigaturnip-b6b5b.firebaseapp.com",projectId:"gigaturnip-b6b5b",storageBucket:"gigaturnip-b6b5b.appspot.com",messagingSenderId:"414429242328",appId:"1:414429242328:web:a4685f5ac6895ea767c8ad",measurementId:"G-Y8JTEJMTET"}),p=Object(h.b)(),x=Object(f.c)(O),g=new h.a;g.setCustomParameters({prompt:"select_account"});var m=n(1),v=c.a.createContext(null),k=function(e){var t=e.children,n=Object(a.useState)(null),c=Object(j.a)(n,2),r=c[0],i=c[1],o=Object(a.useState)(!1),s=Object(j.a)(o,2),u=s[0],b=s[1];Object(a.useEffect)((function(){Object(h.d)(p,function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(t||null),b(!0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var f={user:r,ready:u,getToken:function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.c)(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),login:function(e){return Object(h.e)(p,g).then((function(t){var n=t.user;console.log(n),i(n),e()}))},logout:function(e){return Object(h.f)(p).then((function(){i(null),e()}))}};return Object(m.jsx)(v.Provider,{value:f,children:t})},S=n(19),w=n(576),C=n(579),y=c.a.createContext(null),T=c.a.forwardRef((function(e,t){return Object(m.jsx)(w.a,Object(S.a)({elevation:6,ref:t,variant:"filled"},e))})),_=function(e){var t=e.children,n=Object(a.useState)(!1),c=Object(j.a)(n,2),r=c[0],i=c[1],o=Object(a.useState)(""),s=Object(j.a)(o,2),u=s[0],l=s[1],d=Object(a.useState)("error"),b=Object(j.a)(d,2),h=b[0],f=b[1],O=function(e,t){"clickaway"!==t&&i(!1)},p={open:r,openToast:function(e,t){t&&f(t),l(function(e){switch(typeof e){case"string":return e;case"object":return JSON.stringify(e);default:return String(e)}}(e)),i(!0)},closeToast:O};return Object(m.jsxs)(y.Provider,{value:p,children:[Object(m.jsx)(C.a,{open:r,autoHideDuration:5e3,onClose:O,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(m.jsx)(T,{onClose:O,severity:h,sx:{width:"100%"},children:u})}),t]})},I=function(){return c.a.useContext(v)},E=n(589),B=function(e){var t=e.children,n=I(),a=Object(s.h)();return console.log(n),n.ready&&!n.user?Object(m.jsx)(s.a,{to:"login",state:{from:a}}):n.ready?t:Object(m.jsx)(E.a,{})},P=n(3),D=n(9),q=n(34),N=n(594),A=n(581),L=n(597),R=n(590),F=n(596),J=n(599),W=n(595),z=n(598),V=n(588),G=n(266),U=n.n(G),M=n(268),K=n.n(M),X=n(267),Y=n.n(X),H=n(580),Q=n(591),Z=n(592),$=n(265),ee=n.n($),te=n(583),ne=240,ae=function(e){return{width:ne,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),overflowX:"hidden"}},ce=function(e){return Object(P.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:"calc(".concat(e.spacing(7)," + 1px)")},e.breakpoints.down("sm"),{width:0})},re=Object(D.a)("div")((function(e){var t=e.theme;return Object(S.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:t.spacing(0,1)},t.mixins.toolbar)})),ie=Object(D.a)(R.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,n=e.open;return Object(S.a)({zIndex:t.zIndex.drawer+1,transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},n&&{marginLeft:ne,width:"calc(100% - ".concat(ne,"px)"),transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.enteringScreen})})})),oe=Object(D.a)(A.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,n=e.open;return Object(S.a)(Object(S.a)({width:ne,flexShrink:0,whiteSpace:"nowrap",boxSizing:"border-box"},n&&Object(S.a)(Object(S.a)({},ae(t)),{},{"& .MuiDrawer-paper":ae(t)})),!n&&Object(S.a)(Object(S.a)({},ce(t)),{},{"& .MuiDrawer-paper":ce(t)}))}));function se(e){var t=Object(q.a)(),n=Object(s.j)().campaignId,a=Object(s.i)(),r=I().logout,i=c.a.useState(!1),u=Object(j.a)(i,2),l=u[0],d=u[1],b=e.children,h=[{page:"tasks",title:"\u0417\u0430\u0434\u0430\u043d\u0438\u044f",icon:Object(m.jsx)(ee.a,{})}];return Object(m.jsxs)(N.a,{sx:{display:"flex"},children:[Object(m.jsx)(W.a,{}),Object(m.jsx)(ie,{position:"fixed",open:l,children:Object(m.jsxs)(F.a,{children:[n&&Object(m.jsx)(V.a,{color:"inherit","aria-label":"open drawer",onClick:function(){d(!0)},edge:"start",sx:Object(S.a)({marginRight:"36px"},l&&{display:"none"}),children:Object(m.jsx)(U.a,{})}),Object(m.jsx)(N.a,{sx:{flexGrow:1},children:Object(m.jsx)(L.a,{component:o.b,color:"inherit",underline:"none",variant:"h6",noWrap:!0,to:"/",sx:{"&:hover":{color:"white",boxShadow:"none"}},children:"GigaTurnip Tasks"})}),Object(m.jsx)(te.a,{color:"inherit",onClick:function(){return r((function(){return a("/")}))},children:"\u0412\u044b\u0445\u043e\u0434"})]})}),n&&Object(m.jsxs)(oe,{variant:"permanent",open:l,children:[Object(m.jsx)(re,{children:Object(m.jsx)(V.a,{onClick:function(){d(!1)},children:"rtl"===t.direction?Object(m.jsx)(Y.a,{}):Object(m.jsx)(K.a,{})})}),Object(m.jsx)(z.a,{}),Object(m.jsx)(J.a,{children:h.map((function(e,t){return Object(m.jsxs)(H.a,{component:o.b,to:"campaign/".concat(n,"/").concat(e.page),children:[Object(m.jsx)(Q.a,{children:e.icon}),Object(m.jsx)(Z.a,{primary:e.title})]},t)}))})]}),Object(m.jsxs)(N.a,{component:"main",sx:{flexGrow:1,width:"100%"},children:[Object(m.jsx)(re,{}),b]})]})}var ue,le,de=function(){return Object(m.jsx)("div",{children:Object(m.jsx)(se,{children:Object(m.jsx)(s.b,{})})})},je=n(593),be=function(){var e,t,n=I().login,a=Object(s.i)(),c=Object(s.h)(),r=(null===c||void 0===c||null===(e=c.state)||void 0===e||null===(t=e.from)||void 0===t?void 0:t.pathname)||"/";return Object(m.jsxs)(N.a,{p:3,children:[Object(m.jsx)(je.a,{align:"center",variant:"h4",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(m.jsx)(je.a,{variant:"body1",align:"center",children:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u043a\u043d\u043e\u043f\u043a\u0443 (\u0412\u0445\u043e\u0434 \u0438\u043b\u0438 \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f)."}),Object(m.jsx)(je.a,{variant:"body1",align:"center",children:"\u0415\u0441\u043b\u0438 \u0443 \u0432\u0430\u0441 \u043d\u0435\u0442 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 Google, \u0442\u043e \u0441\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u0435\u0433\u043e."}),Object(m.jsx)(N.a,{display:"flex",justifyContent:"center",p:2,children:Object(m.jsx)(te.a,{size:"large",color:"primary",variant:"contained",fullWidth:!0,onClick:function(){n((function(){return a(r,{replace:!0})}))},children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})})]})},he=n(584),fe=n(601),Oe=n(602),pe=n(600),xe=function(e){var t=e.data,n=e.onClick,a=t.name,c=t.description,r=t.id;return Object(m.jsxs)(pe.a,{children:[Object(m.jsxs)(fe.a,{sx:{pb:1},children:[Object(m.jsx)(je.a,{variant:"h5",component:"div",children:a}),Object(m.jsxs)(je.a,{gutterBottom:!0,variant:"caption",color:"text.secondary",children:["ID: ",r]}),Object(m.jsx)(je.a,{overflow:"hidden",textOverflow:"ellipsis",variant:"body2",sx:{height:60,maxWidth:500},children:c})]}),Object(m.jsx)(Oe.a,{children:Object(m.jsx)(te.a,{size:"small",onClick:function(){n(r)},children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c"})})]})},ge=n(65),me=n(603),ve=n(573),ke=n(269),Se=n.n(ke),we=n(604),Ce=["expand"],ye=Object(D.a)((function(e){e.expand;var t=Object(ge.a)(e,Ce);return Object(m.jsx)(V.a,Object(S.a)({},t))}))((function(e){var t=e.theme;return{transform:e.expand?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest})}})),Te=function(e){var t=e.data,n=e.children,c=e.hideExpandButton,r=e.hideOpenButton,i=e.extraActions,o=e.onClick,s=t.name,u=(t.description,t.id),l=Object(a.useState)(!1),d=Object(j.a)(l,2),b=d[0],h=d[1],f=[];return i&&f.push(i),r||f.push(Object(m.jsx)(te.a,{variant:"contained",onClick:function(){o&&o(u)},children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c"},"open_button")),c||f.push(Object(m.jsx)(ye,{expand:b,onClick:function(){h(!b)},"aria-expanded":b,"aria-label":"show more",children:Object(m.jsx)(Se.a,{})},"expand_button")),Object(m.jsxs)(pe.a,{children:[Object(m.jsx)(me.a,{action:Object(m.jsx)(ve.a,{direction:"row",spacing:1,children:f}),title:s,subheader:"ID: ".concat(u),titleTypographyProps:{variant:"h6"},subheaderTypographyProps:{variant:"caption"}}),Object(m.jsx)(we.a,{in:b,timeout:"auto",unmountOnExit:!0,children:Object(m.jsx)(fe.a,{children:n})})]})},_e=function(e){var t=e.data,n=e.view,a=e.children,c=e.onSelect;return t?"custom"===n?Object(m.jsx)(m.Fragment,{children:a}):"grid"===n?Object(m.jsx)(he.a,{container:!0,py:2,spacing:{xs:2,md:3},columns:{xs:4,sm:8,md:12},children:t.map((function(e,t){return Object(m.jsx)(he.a,{item:!0,xs:2,sm:4,md:4,children:Object(m.jsx)(xe,{data:e,onClick:c})},t)}))}):"list"===n?Object(m.jsx)(he.a,{container:!0,py:2,spacing:2,children:t.map((function(e,t){return Object(m.jsx)(he.a,{item:!0,xs:12,children:Object(m.jsx)(Te,{data:e,hideExpandButton:!0,onClick:c,children:a})},t)}))}):null:Object(m.jsx)(je.a,{children:"Error"})},Ie=n(574),Ee=n(270),Be=n.n(Ee),Pe=n(271),De=n.n(Pe),qe=function(e){var t=e.label,n=e.view,a=e.location,c=e.hideCreateButton,r=e.hideViewButton,i=e.onViewChange;return Object(m.jsxs)(he.a,{container:!0,alignItems:"center",spacing:1,children:[Object(m.jsx)(he.a,{item:!0,flex:1,children:Object(m.jsx)(je.a,{hidden:!t,variant:"h4",children:t})}),Object(m.jsx)(he.a,{item:!0,hidden:c,children:Object(m.jsx)(te.a,{component:o.b,to:"new",state:{from:a},variant:"contained",sx:{"&:hover":{color:"white",boxShadow:"none"}},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})}),Object(m.jsxs)(he.a,{item:!0,hidden:r,children:[Object(m.jsx)(Ie.a,{title:"\u0421\u0435\u0442\u043a\u0430",children:Object(m.jsx)(V.a,{color:"grid"===n?"primary":"default",onClick:function(){return i("grid")},children:Object(m.jsx)(Be.a,{})})}),Object(m.jsx)(Ie.a,{title:"\u0421\u043f\u0438\u0441\u043e\u043a",children:Object(m.jsx)(V.a,{color:"list"===n?"primary":"default",onClick:function(){return i("list")},children:Object(m.jsx)(De.a,{})})})]})]})},Ne=function(e){var t=e.id,n=e.data,c=e.label,r=e.defaultView,i=e.hideCreateButton,o=e.hideViewButton,u=e.children,l=e.hidden,d=e.onSelect,b=Object(s.h)(),h=Object(a.useState)(null!==r&&void 0!==r?r:"grid"),f=Object(j.a)(h,2),O=f[0],p=f[1];Object(a.useEffect)((function(){if(!r){var e=localStorage.getItem("".concat(t,"_view"))||"grid";e&&p(e)}}),[]);return Object(m.jsxs)(N.a,{hidden:l,children:[Object(m.jsx)(qe,{label:c,view:O,onViewChange:function(e){p(e),localStorage.setItem("".concat(t,"_view"),e)},location:b,hideCreateButton:i,hideViewButton:o}),Object(m.jsx)(_e,{data:n,view:O,onSelect:d,children:u})]})},Ae="api/v1/campaigns/",Le="api/v1/chains/",Re="api/v1/taskstages/",Fe="api/v1/conditionalstages/",Je="api/v1/tasks/",We=n(272),ze=n.n(We),Ve=function(){return c.a.useContext(y)},Ge=function(){var e=Ve().openToast,t=I().getToken,n=ze.a.create({baseURL:"https://journal-bb5e3.uc.r.appspot.com/"});n.interceptors.request.use((function(e){return t().then((function(t){return t&&e&&e.headers&&(e.headers.Authorization="JWT "+t),e}))}),(function(e){return Promise.reject(e)}));return{axios:n,getCampaigns:function(){return n.get("".concat(Ae,"?limit=1000")).then((function(e){return e.data})).then((function(e){return e.results}))},getChains:function(t){return n.get("".concat(Le,"?campaign=").concat(t,"&limit=1000")).then((function(e){return e.data})).then((function(e){return e.results})).catch((function(t){return e(t.message)}))},createChain:function(t){return n.post("".concat(Le),t).catch((function(t){return e(t.message)}))},getStageNodes:function(t,a){return n.get("".concat(Re,"?chain__campaign=").concat(t,"&chain=").concat(a,"&limit=1000")).then((function(e){return e.data})).then((function(e){return e.results})).catch((function(t){return e(t.message)}))},getLogicNodes:function(t,a){return n.get("".concat(Fe,"?chain__campaign=").concat(t,"&chain=").concat(a,"&limit=1000")).then((function(e){return e.data})).then((function(e){return e.results})).catch((function(t){return e(t.message)}))},getTaskStage:function(t){return n.get("".concat(Re+t,"/")).then((function(e){return e.data})).catch((function(t){return e(t.message)}))},saveTaskStage:function(t,a){return n.patch("".concat(Re+t,"/"),a).catch((function(t){return e(t.message)}))},getTaskStageOptions:function(){return n.options("".concat(Re)).then((function(e){return e.data})).catch((function(t){return e(t.message)}))},getConditionalStage:function(t){return n.get("".concat(Fe+t,"/")).then((function(e){return e.data})).catch((function(t){return e(t.message)}))},saveConditionalStage:function(t,a){return n.patch("".concat(Fe+t,"/"),a).catch((function(t){return e(t.message)}))},getUserCampaigns:function(){return n.get("".concat(Ae,"list_user_campaigns/")).then((function(e){return e.data}))},getSelectableCampaigns:function(){return n.get(Ae+"list_user_selectable/").then((function(e){return e.data}))},requestCampaignJoin:function(e){return n.post(Ae+e+"/join_campaign/")},requestCampaignInfo:function(e){return n.get(Ae+e+"/").then((function(e){return e.data}))},requestTaskCreation:function(e){return n.post(Re+e+"/create_task/").then((function(e){return e.data}))},requestTaskAssignment:function(e){return n.post(Je+e+"/request_assignment/").then((function(e){return e.data}))},getCompleteTasks:function(e){return n.get("".concat(Je,"user_relevant/?complete=",!0,"&stage__chain__campaign=").concat(e)).then((function(e){return e.data})).then((function(e){return console.log("getCompleteTasks",e),e}))},getOpenTasks:function(e){return n.get("".concat(Je,"user_relevant/?complete=",!1,"&stage__chain__campaign=").concat(e)).then((function(e){return e.data})).then((function(e){return console.log("getOpenTasks",e),e}))},getCreatableTasks:function(e){return n.get("".concat(Re,"user_relevant/?chain__campaign=").concat(e)).then((function(e){return e.data}))},getSelectableTasks:function(e,t,a){console.log(t);var c=function(e,t){return t&&t>0?"".concat(e,"&limit=10&offset=").concat(10*(t-1)):e}("".concat(Je,"user_selectable/?stage__chain__campaign=").concat(e),t);return a&&(a.query&&(c+="&search=".concat(a.query)),a.stage&&(c+="&stage=".concat(a.stage))),console.log("SELECTABLE URL",c),n.get(c).then((function(e){return console.log("getSelectableTasks",e.data),e.data}))},getPreviousTasks:function(e){return n.get("".concat(Je+e,"/list_displayed_previous/")).then((function(e){return e.data}))},getTask:function(e){return n.get("".concat(Je+e,"/")).then((function(e){return e.data}))},saveTask:function(e,t){return n.patch("".concat(Je+e,"/"),t).then((function(e){return e.data}))},releaseTask:function(e){return n.post("".concat(Je+e,"/release_assignment/")).then((function(e){return e.data}))},openPreviousTask:function(e){return n.get("".concat(Je+e,"/open_previous/")).then((function(e){return e.data}))},getIntegratedData:function(e){return n.get("".concat(Je+e,"/get_integrated_tasks/")).then((function(e){return e.data}))},triggerTaskWebhook:function(e){return n.get("".concat(Je+e,"/trigger_webhook/"))}}},Ue=n(605),Me=n(575),Ke=["children","value","index"],Xe=function(e){var t=e.children,n=e.value,a=e.index,c=Object(ge.a)(e,Ke);return Object(m.jsx)("div",Object(S.a)(Object(S.a)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},c),{},{children:n===a&&Object(m.jsx)(N.a,{children:t})}))},Ye=["data","value","onChange"],He=function(e){var t=e.data,n=e.value,a=e.onChange,c=Object(ge.a)(e,Ye);return Object(m.jsxs)(N.a,{sx:{width:"100%"},children:[Object(m.jsx)(N.a,{sx:{borderBottom:1,borderColor:"divider"},children:Object(m.jsx)(Me.a,Object(S.a)(Object(S.a)({value:n,onChange:function(e,t){a(e,t)},"aria-label":"basic tabs example"},c),{},{children:t.map((function(e,t){return Object(m.jsx)(Ue.a,Object(S.a)({label:e.label},function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}(t)),"tab_".concat(t))}))}))}),t.map((function(e,t){return Object(m.jsx)(Xe,{index:t,value:n,children:e.component},"tabpanel_".concat(t))}))]})},Qe=function(){var e=function(e){return e?JSON.parse(e):{}};return{parseId:function(e){if(e)return parseInt(e);throw new Error("No id")},parseJson:e,parseTaskData:function(t){return{responses:t.responses,schema:e(t.stage.json_schema),uiSchema:e(t.stage.ui_schema)}}}},Ze=n(23),$e=n(586),et=n(287),tt=n.n(et),nt=n(286),at=n.n(nt),ct=n(38),rt=n(273),it=n(275),ot=n.n(it),st=n(274),ut=n.n(st),lt=n(67),dt=n(143),jt=function(e){e.schema;var t=e.id,n=e.options,c=e.value,r=e.required,i=e.disabled,o=e.readonly,s=e.label,u=e.formContext,b=e.onChange,h=e.onBlur,O=Object(a.useState)(null),p=Object(j.a)(O,2),g=p[0],v=p[1],k=Object(a.useState)(!1),S=Object(j.a)(k,2),w=S[0],C=S[1],y=u.storagePath,T=!!n.private&&n.private,_=!!n.default&&n.default,I=T?"private":"public",B=Object(f.d)(x,"".concat(I,"/").concat(y));Object(a.useEffect)((function(){_?v(n.default):c&&Object(f.a)(Object(f.d)(x,c)).then((function(e){return v(e)}))}),[c]);var P=dt.a.div(ue||(ue=Object(ct.a)(["\n      width: 10px;\n      height: 10px;\n      margin-left: 8px;\n      border-radius: 50%;\n      background-color: red;\n      animation: "," 1s linear infinite;\n    "])),Object(lt.c)(le||(le=Object(ct.a)(["50% {opacity: 0;}"])))),D=function(){var e=Object(d.a)(l.a.mark((function e(n,a){var c,r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),v(n),c=a.type.split("/")[1],r=t.replace(/\./g,"_").replace(/ /g,"_")+"."+c,i=Object(f.d)(B,r),e.next=7,Object(f.e)(i,a).then((function(e){return e.ref.fullPath}));case 7:o=e.sent,C(!1),b(o),h(t,o);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),q=Object(rt.useReactMediaRecorder)({video:!1,onStop:D}),A=q.status,L=q.startRecording,R=q.stopRecording;return Object(m.jsxs)(N.a,{children:[Object(m.jsxs)("label",{className:"form-label",children:[s,r&&"*"]}),!_&&Object(m.jsxs)(he.a,{container:!0,alignItems:"center",children:[Object(m.jsx)(he.a,{item:!0,children:function(e){switch(e){case"recording":return Object(m.jsx)(te.a,{variant:"contained",onClick:R,sx:{marginBottom:1},disabled:i||o,endIcon:Object(m.jsx)(ut.a,{}),children:"\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"});default:return Object(m.jsx)(te.a,{variant:"contained",onClick:L,sx:{marginBottom:1},disabled:i||o,endIcon:Object(m.jsx)(ot.a,{sx:{fill:i||o?"grey":"red"}}),children:"\u0417\u0430\u043f\u0438\u0441\u044c"})}}(A)}),Object(m.jsx)(he.a,{item:!0,children:"recording"===A&&Object(m.jsx)(P,{})}),Object(m.jsx)(he.a,{item:!0,children:w&&Object(m.jsx)(E.a,{sx:{marginLeft:1},size:30})})]}),g&&Object(m.jsx)(he.a,{container:!0,children:Object(m.jsx)("audio",{controls:!0,src:g})})]})},bt=n(25),ht=function(e){var t=e.id,n=e.placeholder,a=e.required,c=e.readonly,r=e.disabled,i=e.label,o=e.value,s=e.onChange,u=e.onBlur,l=e.onFocus,d=e.autofocus,j=e.options,b=e.schema,h=e.rawErrors,f=void 0===h?[]:h,O="string"===b.type?"text":"".concat(b.type);return Object(m.jsxs)(bt.a.Group,{className:"mb-0",children:[Object(m.jsxs)(bt.a.Label,{className:f.length>0?"text-danger":"",children:[i||b.title,(i||b.title)&&a?"*":null]}),Object(m.jsx)(bt.a.Control,{id:t,placeholder:n,autoFocus:d,required:a,disabled:r,readOnly:c,className:f.length>0?"is-invalid":"",list:b.examples?"examples_".concat(t):void 0,type:O,value:o||0===o?o:"",onChange:function(e){var t=e.target.value;return s(""===t?j.emptyValue:t)},onBlur:function(e){var n=e.target.value;return u(t,n)},onFocus:function(e){var n=e.target.value;return l(t,n)}}),b.examples?Object(m.jsx)("datalist",{id:"examples_".concat(t),children:b.examples.concat(b.default?[b.default]:[]).map((function(e){return Object(m.jsx)("option",{value:e},e)}))}):null]})},ft=function(e,t,n){return n&&e?Object(S.a)(Object(S.a)({},e),t):t},Ot=function(){var e=Object(d.a)(l.a.mark((function e(t,n,a,c,r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}return r||(a({}),c({})),e.next=4,Promise.all(t.map(function(){var e=Object(d.a)(l.a.mark((function e(t){var i,o,s,u,d,j;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.name.lastIndexOf("."),o=t.name.substring(0,i),s=t.name.substring(i),u=o.replace(/\./g,"_").replace(/ /g,"_")+s,d=Object(f.d)(n,t.name),j=Object(f.f)(d,t),a((function(e){var t=Object(P.a)({},u,{status:"loading",progress:0});return e?Object(S.a)(Object(S.a)({},e),t):t})),j.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;a((function(e){var n=Object(P.a)({},u,{status:"loading",progress:t});return e?Object(S.a)(Object(S.a)({},e),n):n}))}),(function(e){console.log(e)}),(function(){Object(f.a)(j.snapshot.ref).then((function(e){var t=j.snapshot.ref.fullPath,n=e;a((function(e){var t=Object(P.a)({},u,{status:"complete",progress:100,url:n});return ft(e,t,r)})),c((function(e){var n=Object(P.a)({},u,t);return ft(e,n,r)}))}))}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,c,r){return e.apply(this,arguments)}}(),pt=n(606),xt=function(e){return Object(m.jsxs)(N.a,{display:"flex",alignItems:"center",children:[Object(m.jsx)(N.a,{width:"100%",mr:1,children:Object(m.jsx)(pt.a,Object(S.a)({variant:"determinate"},e))}),Object(m.jsx)(N.a,{minWidth:35,children:Object(m.jsx)(je.a,{variant:"body2",color:"textSecondary",children:"".concat(Math.round(e.value),"%")})})]})},gt=n(276),mt=n(585),vt=function(e){var t=e.schema,n=e.uiSchema,c=e.disabled,r=e.required,i=e.formContext,o=e.value,s=e.id,u=i.storagePath,b=Object(a.useState)({}),h=Object(j.a)(b,2),O=h[0],p=h[1],g=Object(a.useState)({}),v=Object(j.a)(g,2),k=v[0],w=v[1],C=Object(a.useState)(""),y=Object(j.a)(C,2),T=y[0],_=y[1],I=Object(a.useState)(!1),E=Object(j.a)(I,2),B=E[0],D=E[1],q=Object(a.useState)(!1),N=Object(j.a)(q,2),A=N[0],L=N[1],R=Object(a.useState)(""),F=Object(j.a)(R,2),J=F[0],W=F[1],z=Object(a.useState)({}),V=Object(j.a)(z,2),G=V[0],U=V[1],M=!(!n["ui:options"]||!n["ui:options"].private)&&n["ui:options"].private,K=!(!n["ui:options"]||!n["ui:options"].multiple)&&n["ui:options"].multiple,X=Object.keys(O).length>0,Y=r&&!X,H=M?"private":"public",Q=Object(f.d)(x,"".concat(H,"/").concat(u));Object(a.useEffect)((function(){if(o&&Object.keys(o).length>0){var e=JSON.parse(o);U(e),Object.keys(e).forEach((function(t){var n=Object(f.d)(x,e[t]);Object(f.a)(n).then((function(e){return p((function(n){return Object(S.a)(Object(S.a)({},n),{},Object(P.a)({},t,{url:e,status:"complete"}))}))}))}))}}),[o]);var Z=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ot(Object(Ze.a)(t.target.files),Q,p,w,K);case 2:t.target.value=null;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){return e.onBlur(s,O)};Object(a.useEffect)((function(){var t=function(){var t=Object(d.a)(l.a.mark((function t(){var n,a,c,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n="",K?(a=JSON.parse(o),c=Object(S.a)(Object(S.a)({},a),k),n=JSON.stringify(c)):n=JSON.stringify(k),t.next=5,e.onChange(n);case 5:t.next=13;break;case 7:return t.prev=7,t.t0=t.catch(0),r=JSON.stringify(k),console.error(t.t0),t.next=13,e.onChange(r);case 13:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();k&&Object.keys(k).length>0&&(console.log("fileLinks",k),t().then((function(){return $()})))}),[k]);var ee=function(){var t=Object(d.a)(l.a.mark((function t(n){var a,c,r,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n in(a=G))){t.next=7;break}return delete a[n],c=JSON.stringify(a),t.next=6,e.onChange(c);case 6:$();case 7:r=Object(S.a)({},k),n in r&&(delete r[n],w(r)),i=Object(S.a)({},O),n in i&&(delete i[n],p(i)),console.log("DELETE LOG",i);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),te=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,c,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=G,console.log("FILE CLICK VALUE",n),!(t in n)){e.next=24;break}return a=n[t],console.log(a),e.next=7,Object(f.b)(Object(f.d)(x,a));case 7:if(!(c=e.sent)||!c.contentType){e.next=24;break}r=c.contentType.split("/")[0],i=c.contentType.split("/")[1],console.log("FILE TYPE",r),e.t0=r,e.next="image"===e.t0?15:"video"===e.t0?19:23;break;case 15:return _(O[t].url),W(c.contentType),D(!0),e.abrupt("break",24);case 19:return _(O[t].url),W("quicktime"===i?"video/mp4":c.contentType),L(!0),e.abrupt("break",24);case 23:window.open(O[t].url,"_blank");case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){_(""),W(""),D(!1),L(!1)};return Object(m.jsxs)("div",{children:[B&&Object(m.jsx)(gt.a,{src:[T],disableScroll:!1,backgroundStyle:{backgroundColor:"rgba(0,0,0,0.8)"},closeOnClickOutside:!0,onClose:ne}),Object(m.jsx)(mt.a,{open:A,onClose:ne,fullWidth:!0,children:Object(m.jsxs)("video",{height:"360px",controls:!0,children:[Object(m.jsx)("source",{src:T,type:J}),"Your browser does not support the video tag."]})}),Object(m.jsx)("label",{className:"form-label",children:null===t||void 0===t?void 0:t.title}),Object(m.jsx)("br",{}),Object(m.jsx)("input",{disabled:c,required:Y,multiple:K,type:"file",onChange:Z,onBlur:$,onFocus:function(){return e.onFocus(s,O)}}),Object.keys(O).map((function(e,t){return Object(m.jsxs)("div",{children:[Object(m.jsxs)("div",{style:{display:"flex",alignItems:"baseline"},children:[Object(m.jsx)("p",{children:e}),"complete"===O[e].status&&Object(m.jsxs)("div",{style:{display:"flex",alignItems:"baseline"},children:[Object(m.jsx)("button",{onClick:function(){return te(e)},style:{fontSize:"14px",padding:0,margin:"0 10px"},type:"button",className:"btn btn-link text-success",children:"\u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0444\u0430\u0439\u043b"}),!c&&Object(m.jsx)("button",{onClick:function(){return ee(e)},style:{fontSize:"14px",padding:0,margin:"0 10px"},type:"button",className:"btn btn-link text-danger",children:"\u0443\u0434\u0430\u043b\u0438\u0442\u044c"})]})]}),"loading"===O[e].status&&Object(m.jsx)(xt,{value:O[e].progress})]},e)}))]})},kt=function(e){var t=e.required,n=e.label,a=e.value,c=e.schema,r=e.rawErrors,i=void 0===r?[]:r;return a?Object(m.jsxs)(bt.a.Group,{className:"mb-0",children:[Object(m.jsxs)(bt.a.Label,{className:i.length>0?"text-danger":"",children:[n||c.title,(n||c.title)&&t?"*":null]}),Object(m.jsx)("br",{}),Object(m.jsx)("a",{href:a,children:a})]}):null},St=function(e){var t=e.id,n=e.schema,a=e.options,c=e.value,r=e.required,i=e.disabled,o=e.readonly,s=e.label,u=e.onChange,l=e.onBlur,d=e.onFocus,j=a.enumOptions,b=a.enumDisabled,h=function(e){var t=e.target.value;return u("boolean"==n.type?"false"!==t:t)},f=function(e){var n=e.target.value;return l(t,n)},O=function(e){var n=e.target.value;return d(t,n)},p=Boolean(a&&a.inline);return Object(m.jsxs)(bt.a.Group,{className:"mb-0",children:[Object(m.jsxs)(bt.a.Label,{className:"d-block",children:[s||n.title,(s||n.title)&&r?"*":null]}),j.map((function(e,n){var a=Array.isArray(b)&&-1!==b.indexOf(e.value),s=e.value==c;return Object(m.jsx)(bt.a.Check,{inline:p,label:e.label,id:"".concat(t,"_").concat(e.label),name:t,type:"radio",disabled:i||a||o,checked:s,required:r,value:e.value,onChange:h,onBlur:f,onFocus:O},n)}))]})},wt=n(290),Ct=(n(521),["schema","uiSchema","formData","hideButton","onChange","onSubmit","children","disabled"]),yt=function(e){var t=e.schema,n=e.uiSchema,a=e.formData,c=e.hideButton,r=e.onChange,i=e.onSubmit,o=e.children,s=e.disabled,u=Object(ge.a)(e,Ct),l={customfile:vt,autocomplete:ht,RadioWidget:St,customlink:kt,audio:jt};return Object(m.jsx)(wt.a,Object(S.a)(Object(S.a)({schema:t,uiSchema:n,formData:a,widgets:l,onChange:function(e){if(!r)return 0;r(e.formData)},onSubmit:function(e){if(!i)return 0;i(e.formData)},disabled:s},u),{},{children:o||(c?" ":Object(m.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:s,children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"}))}))},Tt=function(e){var t=e.data,n=e.view,a=e.complete,c=e.previousTasks,r=e.formData,i=e.disabled,o=e.hideSubmit,s=e.onChange,u=e.onSubmit,l=e.onRelease,d=e.onPrevious,j=t.id,b=t.schema,h=t.uiSchema,f=t.stage,O=f.id,p=f.allow_go_back,x=f.allow_release,g=t.stage.chain,v=g.id,k=g.campaign,S=i||a,w=I().user,C=w?"".concat(k,"/").concat(v,"/").concat(O,"/").concat(w.uid,"/").concat(j):null,y=function(e){return Array.isArray(e)&&e.length>0?e.map((function(e,t){var n=e.responses,a=e.schema,c=e.uiSchema;return Object(m.jsx)(yt,{schema:a,uiSchema:c,formData:n,hideButton:!0,disabled:!0},"prev_task_".concat(t))})):null},T=function(){return Object(m.jsxs)(ve.a,{spacing:1,py:1,children:[Object(m.jsx)(te.a,{type:"submit",variant:"contained",hidden:o,disabled:S,children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"}),Object(m.jsx)(te.a,{hidden:!p,variant:"contained",color:"warning",disabled:S,onClick:d,children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u0435"}),Object(m.jsx)(te.a,{hidden:!x,variant:"contained",color:"error",disabled:S,onClick:l,children:"\u041e\u0441\u0432\u043e\u0431\u043e\u0434\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435"})]})};return"split"===n&&Array.isArray(c)&&c.length>0?Object(m.jsxs)(he.a,{container:!0,direction:"row",spacing:1,children:[Object(m.jsx)(he.a,{container:!0,item:!0,sm:6,xs:12,sx:{display:"block"},children:y(c)}),Object(m.jsx)(he.a,{container:!0,item:!0,sm:6,xs:12,sx:{display:"block"},children:Object(m.jsx)(yt,{schema:b,uiSchema:h,formData:r,onChange:s,onSubmit:u,formContext:{storagePath:C},disabled:S,children:T()})})]}):Object(m.jsxs)(N.a,{children:[y(c),Object(m.jsx)(yt,{schema:b,uiSchema:h,formData:r,onChange:s,onSubmit:u,formContext:{storagePath:C},disabled:S,children:T()})]})},_t=["active","onRequest","onOpen","onAction","hideSubmit","hideOpen"],It=function(e){var t=e.active,n=e.onRequest,a=e.onOpen,c=e.onAction,r=e.hideSubmit,i=e.hideOpen,o=Object(ge.a)(e,_t),s={name:e.data.stage.name,id:e.data.id},u=t?Object(m.jsx)(Ie.a,{title:"\u041f\u043e\u043b\u0443\u0447\u0435\u043d",children:Object(m.jsx)(V.a,{color:"primary",size:"small",onClick:c,children:Object(m.jsx)(at.a,{color:"primary",fontSize:"large"})})},"edit_button"):Object(m.jsx)(te.a,{variant:"contained",onClick:n,children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"},"edit_button");return Object(m.jsx)(Te,{data:s,extraActions:[u],hideOpenButton:i,onClick:a,children:Object(m.jsx)(Tt,Object(S.a)(Object(S.a)({},o),{},{hideSubmit:r,disabled:!t}))})},Et=function(e){var t=e.id,n=e.view,c=e.active,r=e.hideSubmit,i=e.hideOpen,o=(e.fullwidth,e.disabled),u=e.getData,b=e.getPreviousData,h=e.saveData,f=e.releaseTask,O=e.debouncedSave,p=e.openPreviousTask,x=e.handleRedirect,g=(e.handlePrompt,e.openToast),v=e.requestTask,k=e.onAction,w=e.updateState,C=Object(s.i)(),y=Object(a.useState)(),T=Object(j.a)(y,2),_=T[0],I=T[1],E=Object(a.useState)(),B=Object(j.a)(E,2),P=B[0],D=B[1],q=Object(a.useState)(!1),A=Object(j.a)(q,2),L=A[0],R=A[1],F=Object(a.useState)([]),J=Object(j.a)(F,2),W=J[0],z=J[1],V=Object(a.useState)(null!==c&&void 0!==c&&c),G=Object(j.a)(V,2),U=G[0],M=G[1],K=Object(a.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(t);case 2:return n=e.sent,e.next=5,b(t);case 5:a=e.sent,z(a),I(n),D(n.responses),R(n.complete);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);Object(a.useEffect)((function(){K(t)}),[K,t]),Object(a.useEffect)((function(){"boolean"===typeof c&&M(c)}),[c]);Object(a.useEffect)((function(){O(t,{responses:P})}),[P,L,O,t]);var X={data:_,formData:P,complete:L,previousTasks:W,disabled:o,onChange:function(e){D(e)},onSubmit:function(e){return h(t,{responses:e,complete:!0}).then((function(e){g("\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b","success"),M(!1),w()})).catch((function(e){return g(e.message,"error")}))},onRelease:function(){f(t).then((function(){return M(!1)}))},onPrevious:function(){p(t).then((function(e){var n=e.id;x(t,n,K)}))},onOpen:function(){U?C("".concat(t)):v(t).then((function(e){var t=e.id;C("".concat(t))}))},onRequest:function(){k?k(t,"add"):v(t).then((function(e){return K(e.id)})).then((function(){return M(!0)}))}};return _?Object(m.jsx)(N.a,{children:Object(m.jsx)(It,Object(S.a)({active:U,hideOpen:i,onAction:function(){if(!k)return null;k(t,"remove")},hideSubmit:r,view:n},X))}):null},Bt=Object(D.a)(N.a)((function(){return{width:"70%",minWidth:"400px",margin:"0 auto"}})),Pt=function(e){var t=e.id,n=e.view,c=e.fullwidth,r=e.disabled,i=e.getData,o=e.getPreviousData,u=e.saveData,b=e.releaseTask,h=e.debouncedSave,f=e.openPreviousTask,O=e.handleRedirect,p=e.handlePrompt,x=e.openToast,g=e.update,v=e.forceUpdate,k=Object(s.i)(),w=Object(a.useState)(),C=Object(j.a)(w,2),y=C[0],T=C[1],_=Object(a.useState)(),I=Object(j.a)(_,2),E=I[0],B=I[1],P=Object(a.useState)(!1),D=Object(j.a)(P,2),q=D[0],A=D[1],L=Object(a.useState)([]),R=Object(j.a)(L,2),F=R[0],J=R[1],W=Object(a.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t);case 2:return n=e.sent,e.next=5,o(t);case 5:a=e.sent,console.log("updated"),J(a),T(n),B(n.responses),A(n.complete);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);Object(a.useEffect)((function(){W(t)}),[W,t]),Object(a.useEffect)((function(){g&&v&&W(t).then((function(){return v(!1)}))}),[g]);Object(a.useEffect)((function(){h(t,{responses:E}),p(!q)}),[E,q,h,t]);var z={data:y,formData:E,complete:q,previousTasks:F,disabled:r,onChange:function(e){B(e)},onSubmit:function(e){return u(t,{responses:e,complete:!0}).then((function(e){p(!1),x("\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b","success");var n=e.next_direct_id;O(t,n,W)})).catch((function(e){return x(e.message,"error")}))},onRelease:function(){p(!1),b(t).then((function(){return k("../..")}))},onPrevious:function(){f(t).then((function(e){var n=e.id;O(t,n,W)}))}};return y?c?Object(m.jsx)(N.a,{children:Object(m.jsx)(Tt,Object(S.a)({view:n},z))}):Object(m.jsx)(Bt,{children:Object(m.jsx)(Tt,Object(S.a)({view:n},z))}):null},Dt=function(e){var t=e.id,n=e.getIntegrated,c=e.triggerWebhook,r=Object(a.useState)([]),i=Object(j.a)(r,2),o=i[0],s=i[1],u=Object(a.useState)([]),b=Object(j.a)(u,2),h=b[0],f=b[1],O=Object(a.useState)(!1),p=Object(j.a)(O,2),x=p[0],g=p[1],v=Object(a.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t);case 2:a=e.sent,s(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);Object(a.useEffect)((function(){v(t)}),[v,t]);var k=function(e,t){if("add"===t){var n=Array.from(new Set([].concat(Object(Ze.a)(h),[e])));f(n)}if("remove"===t){var a=Object(Ze.a)(h),c=a.indexOf(e);c>-1&&(a.splice(c,1),f(a))}};return Object(m.jsxs)(N.a,{children:[Object(m.jsx)(he.a,{container:!0,spacing:2,children:o.map((function(t,n){return Object(m.jsx)(he.a,{item:!0,width:"100%",children:Object(m.jsx)(Et,Object(S.a)(Object(S.a)({},e),{},{onAction:k,hideSubmit:!0,active:h.includes(t.id),id:t.id}))},n)}))}),Object(m.jsx)(N.a,{pt:2,children:Object(m.jsx)(te.a,{fullWidth:!0,color:"warning",variant:"contained",onClick:function(){c(t).then((function(){return g(!0)}))},children:"\u0421\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0444\u043e\u0440\u043c\u0443"})}),Object(m.jsx)(z.a,{sx:{py:2},children:Object(m.jsx)($e.a,{icon:Object(m.jsx)(tt.a,{}),label:"\u041e\u0431\u043e\u0431\u0449\u0430\u044e\u0449\u0430\u044f \u0444\u043e\u0440\u043c\u0430"})}),Object(m.jsx)(Pt,Object(S.a)({fullwidth:!0,update:x,forceUpdate:function(e){g(e)}},e))]})},qt=n(288),Nt=n.n(qt);function At(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Object(a.useContext)(s.f),c=n.navigator;Object(a.useEffect)((function(){if(t){var n=c.block((function(t){var a=Object(S.a)(Object(S.a)({},t),{},{retry:function(){n(),setTimeout((function(){return t.retry()}),100)}});e(a)}));return n}}),[c,e,t])}var Lt=n(292),Rt=function(e){var t=e.data,n=e.hidden;return Object(m.jsx)(N.a,{hidden:n,children:Object(m.jsx)(Lt.a,{id:"ViewerTinyMCE",value:t,inline:!1,disabled:!0,tinymceScriptSrc:"/GigaTurnipTaskView/tinymce/tinymce.min.js",init:{plugins:"autoresize",toolbar:!1,menubar:!1,image_advtab:!0,importcss_append:!0}})})},Ft=function(e){var t,n,c=e.variant,r=e.id,i=e.view,o=e.updateState,u=(e.active,e.hidePrompt),l=e.fullWidth,d=Object(s.j)().taskId,b=Ge(),h=b.getTask,f=b.saveTask,O=b.getPreviousTasks,p=b.releaseTask,x=b.openPreviousTask,g=b.requestTaskAssignment,v=b.getIntegratedData,k=b.triggerTaskWebhook,w=Ve().openToast,C=Object(s.i)(),y=Qe(),T=y.parseId,_=y.parseTaskData,I=r||T(d),E=Object(a.useState)(!1),B=Object(j.a)(E,2),P=B[0],D=B[1],q=Object(a.useState)(),A=Object(j.a)(q,2),L=A[0],R=A[1];!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];At(Object(a.useCallback)((function(t){var n;"function"===typeof e?"string"===typeof(n=e(t.location,t.action))&&(n=window.confirm(n)):n=window.confirm(e),n&&t.retry()}),[e]),t)}("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u043a\u0438\u043d\u0443\u0442\u044c \u044d\u0442\u0443 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443?",!u&&P);var F=Object(a.useCallback)((function(e){return h(e).then((function(e){return Object(S.a)(Object(S.a)({},e),_(e))}))}),[]),J=Object(a.useCallback)((function(e){return O(e).then((function(e){return e.map((function(e){return _(e)}))}))}),[]),W=Object(a.useCallback)((function(e){return v(e)}),[]),z=Object(a.useCallback)((function(e){return p(e)}),[]),V=Object(a.useCallback)((function(e){return x(e)}),[]),G=Object(a.useCallback)((function(e){return g(e)}),[]),U=Object(a.useCallback)((function(e){return k(e)}),[]),M=Object(a.useCallback)((function(e,t){return f(e,t)}),[]),K=Object(a.useCallback)(Nt()((function(e,t){return M(e,t)}),2e3),[]),X=Object(a.useCallback)((function(e,t,n){t?t===e?n(e):C("../../".concat(t)):C("../..")}),[]),Y=Object(a.useCallback)((function(e){D(e)}),[]),H=Object(a.useCallback)((function(e){F(e).then((function(e){return R(e)}))}),[]);Object(a.useEffect)((function(){H(I)}),[]);var Q={getData:F,getPreviousData:J,getIntegrated:W,releaseTask:z,requestTask:G,triggerWebhook:U,saveData:M,debouncedSave:K,openPreviousTask:V,handleRedirect:X,handlePrompt:Y,openToast:w,updateState:null!==o&&void 0!==o?o:H};return"quick"===c?Object(m.jsx)(N.a,{children:Object(m.jsx)(Et,Object(S.a)({id:I,view:i,fullwidth:l},Q))}):"integrated"===c||(null===L||void 0===L?void 0:L.integrator_group)?Object(m.jsx)(N.a,{p:2,children:Object(m.jsx)(Dt,Object(S.a)({id:I},Q))}):Object(m.jsxs)(N.a,{p:2,children:[Object(m.jsx)(Rt,{data:null===L||void 0===L||null===(t=L.stage)||void 0===t?void 0:t.rich_text,hidden:!(null===L||void 0===L||null===(n=L.stage)||void 0===n?void 0:n.rich_text)}),Object(m.jsx)(Pt,Object(S.a)({id:I,view:i,fullwidth:!0},Q))]})},Jt=function(){var e=Ge(),t=e.getOpenTasks,n=e.getCompleteTasks,c=e.getCreatableTasks,r=e.requestTaskCreation,i=e.getSelectableTasks,o=Object(s.i)(),u=Object(s.j)().campaignId,l=(0,Qe().parseId)(u),d=Object(a.useState)([]),b=Object(j.a)(d,2),h=b[0],f=b[1],O=Object(a.useState)([]),p=Object(j.a)(O,2),x=p[0],g=p[1],v=Object(a.useState)([]),k=Object(j.a)(v,2),S=k[0],w=k[1],C=Object(a.useState)(0),y=Object(j.a)(C,2),T=y[0],_=y[1],I=function(e){o("/campaign/".concat(u,"/tasks/").concat(e))},E=[{label:"\u041e\u0442\u043a\u0440\u044b\u0442\u044b\u0435",component:Object(m.jsx)(Ne,{id:"open_tasks",data:h,onSelect:I,hideCreateButton:!0})},{label:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u044b\u0435",component:Object(m.jsx)(Ne,{id:"complete_tasks",data:h,onSelect:I,hideCreateButton:!0})}],B=Object(a.useCallback)((function(e,a){switch(a){case 0:return t(e);case 1:return n(e);default:return t(e)}}),[]),P=Object(a.useCallback)((function(e){B(l,e).then((function(e){return function(e){return e.map((function(e){return{id:e.id,name:e.stage.name,description:e.stage.description}}))}(e)})).then((function(e){return f(e)})),c(l).then((function(e){return g(e)})),i(l).then((function(e){return w(e)}))}),[l]);return Object(a.useEffect)((function(){P(T)}),[P,T]),S.count>0?E.push({label:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435",component:Object(m.jsx)(he.a,{container:!0,py:2,spacing:2,children:S.results.map((function(e,t){return Object(m.jsx)(he.a,{item:!0,xs:12,children:Object(m.jsx)(Ft,{id:e.id,view:"split",updateState:P,hidePrompt:!0,variant:"quick"})},t)}))})}):2===T&&_(0),Object(m.jsxs)(N.a,{px:3,children:[Object(m.jsx)(Ne,{id:"creatable_tasks",data:x,onSelect:function(e){r(e).then((function(e){return I(e.id)}))},hideViewButton:!0,hideCreateButton:!0}),Object(m.jsx)(He,{data:E,value:T,onChange:function(e,t){_(t)},variant:"fullWidth"})]})},Wt=function(){var e=Ge(),t=e.getUserCampaigns,n=e.getSelectableCampaigns,c=Object(s.i)(),r=Object(a.useState)([]),i=Object(j.a)(r,2),o=i[0],u=i[1],l=Object(a.useState)([]),d=Object(j.a)(l,2),b=d[0],h=d[1];Object(a.useEffect)((function(){t().then((function(e){return u(e)})),n().then((function(e){return h(e)}))}),[]);return Object(m.jsxs)(N.a,{px:3,py:1,children:[Object(m.jsx)(Ne,{id:"user_campaigns",data:o,hideCreateButton:!0,label:"\u041a\u0430\u043c\u043f\u0430\u043d\u0438\u0438",onSelect:function(e){c("/campaign/".concat(e,"/tasks"))}}),Object(m.jsx)(Ne,{hidden:0===b.length,id:"selectable_campaigns",data:b,hideCreateButton:!0,label:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u043a\u0430\u043c\u043f\u0430\u043d\u0438\u0438",onSelect:function(e){c("/campaign/".concat(e,"/about"))}})]})},zt=n(289),Vt=function(e){Object(zt.a)(e);var t=Ge(),n=t.requestCampaignInfo,c=t.requestCampaignJoin,r=Object(s.i)(),i=Object(s.j)().campaignId,o=(0,Qe().parseId)(i),u=Object(a.useState)(""),l=Object(j.a)(u,2),d=l[0],b=l[1],h=Object(a.useState)(""),f=Object(j.a)(h,2),O=f[0],p=f[1],x=Object(a.useState)(""),g=Object(j.a)(x,2),v=g[0],k=g[1];Object(a.useEffect)((function(){n(o).then((function(e){var t=e.richText,n=e.name,a=e.description;n&&b(n),a&&p(a),t&&k(t)}))}),[o]);return Object(m.jsxs)(Bt,{children:[Object(m.jsx)(je.a,{variant:"h3",align:"center",children:d}),Object(m.jsx)(je.a,{variant:"h6",align:"center",children:O}),v&&Object(m.jsx)(Rt,{data:v}),Object(m.jsx)(te.a,{variant:"contained",color:"warning",fullWidth:!0,onClick:function(){c(o).then((function(){return r("/campaign/".concat(i,"/tasks"))}))},children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f / \u041a\u043e\u0448\u0443\u043b\u0443\u0443"})]})},Gt=function(){return Object(m.jsx)(k,{children:Object(m.jsx)(_,{children:Object(m.jsx)(o.a,{children:Object(m.jsxs)(s.e,{children:[Object(m.jsxs)(s.c,{path:"/",element:Object(m.jsx)(B,{children:Object(m.jsx)(de,{})}),children:[Object(m.jsxs)(s.c,{path:"campaign",children:[Object(m.jsxs)(s.c,{path:":campaignId",children:[Object(m.jsx)(s.c,{path:"about",element:Object(m.jsx)(Vt,{})}),Object(m.jsxs)(s.c,{path:"tasks",children:[Object(m.jsx)(s.c,{path:":taskId",children:Object(m.jsx)(s.c,{index:!0,element:Object(m.jsx)(Ft,{})})}),Object(m.jsx)(s.c,{index:!0,element:Object(m.jsx)(Jt,{})})]}),Object(m.jsx)(s.c,{index:!0,element:Object(m.jsx)(Jt,{})})]}),Object(m.jsx)(s.c,{index:!0,element:Object(m.jsx)(Wt,{})})]}),Object(m.jsx)(s.c,{index:!0,element:Object(m.jsx)(Wt,{})})]}),Object(m.jsx)(s.c,{path:"login",element:Object(m.jsx)(be,{})})]})})})})},Ut=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,607)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};i.a.render(Object(m.jsx)(Gt,{}),document.getElementById("root")),Ut()}},[[522,1,2]]]);
//# sourceMappingURL=main.93d16132.chunk.js.map
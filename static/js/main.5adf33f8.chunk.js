(this["webpackJsonpgigaturnip-taskview"]=this["webpackJsonpgigaturnip-taskview"]||[]).push([[0],{266:function(e,t,n){},473:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(21),r=n.n(i),s=(n(266),n(154)),o=n.n(s),l=n(231),j=n(18),d=n(158),u=n(24),b=n(243),h="api/v1/campaigns/",p="api/v1/tasks/",O=n.n(b).a.create({baseURL:"https://journal-bb5e3.uc.r.appspot.com/"});O.interceptors.request.use((function(e){var t=localStorage.getItem("token");return t&&(e.headers.Authorization="JWT "+t),e}),(function(e){return Promise.reject(e)}));var g=O,m=(n(460),n(4)),x=function(e){var t=e.schema,n=e.disabled;return Object(m.jsxs)("div",{children:[Object(m.jsx)("label",{className:"form-label",children:null===t||void 0===t?void 0:t.title}),Object(m.jsx)("br",{}),Object(m.jsx)("input",{disabled:n,type:"file"})]})},f=n(115),v=n(506),w=n(116),S=function(){var e=Object(u.g)().id,t=Object(u.f)(),n=Object(a.useState)({}),c=Object(j.a)(n,2),i=c[0],r=c[1],s=Object(a.useState)({}),b=Object(j.a)(s,2),h=b[0],O=b[1],S=Object(a.useState)({}),C=Object(j.a)(S,2),k=C[0],y=C[1],I=Object(a.useState)(!1),N=Object(j.a)(I,2),B=N[0],_=N[1],T=Object(a.useState)([]),z=Object(j.a)(T,2),P=z[0],E=z[1],U={customfile:x};Object(a.useEffect)((function(){var t=function(t,n){return t&&n?g.get("".concat(p,"?stage=").concat(t,"&case=").concat(n)).then((function(e){return e.data})):g.get(p+e+"/").then((function(e){return e.data}))};e&&function(){var e=Object(l.a)(o.a.mark((function e(){var n,a,c,i,s,l,j,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,a=n.stage,console.log(n,a),c=JSON.parse(a.json_schema),i=JSON.parse(a.ui_schema),s=n.case,l=a.displayed_prev_stages,console.log(l),j=l.map((function(e){return t(e,s)})),e.next=13,Promise.all(j).then((function(e){return console.log(e),e.map((function(e){return e.map((function(e){return{responses:e.responses,json_schema:JSON.parse(e.stage.json_schema),ui_schema:JSON.parse(e.stage.ui_schema)}}))})).flat()}));case 13:d=e.sent,console.log("inTasks",d),E(d),y(n.responses),r(c),O(i),_(n.complete);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[e]);return Object(m.jsxs)("div",{style:{width:"70%",minWidth:"400px",margin:"0 auto",display:"block",padding:10},children:[P.length>0&&Object(m.jsxs)(v.a,{children:[Object(m.jsx)(w.a,{variant:"h4",align:"center",style:{padding:10},children:"Previous Tasks"}),P.map((function(e,t){return Object(m.jsx)(d.a,{schema:e.json_schema,uiSchema:e.ui_schema,formData:e.responses,widgets:U,disabled:!0,children:" "},"prev_task_".concat(t))}))]}),Object(m.jsxs)(v.a,{children:[P.length>0&&Object(m.jsx)(w.a,{variant:"h4",align:"center",style:{padding:10},children:"Current Task"}),Object(m.jsx)(d.a,{schema:i,uiSchema:h,formData:k,widgets:U,disabled:B,onChange:function(e){y(e.formData)},onSubmit:function(){console.log(k);var n={responses:k,complete:!0};g.patch(p+e+"/",n).then((function(){return alert("Saved")})).then((function(){return t.goBack()}))},children:Object(m.jsx)(f.a,{type:"submit",disabled:B,children:"Submit"})})]})]})},C=n(43),k=n(15),y=n(7),I=n(509),N=n(530),B=n(31),_=n(518),T=n(247),z=n.n(T),P=n(246),E=n.n(P),U=n(248),A=n.n(U),G=n(245),J=n.n(G),L=n(510),W=n(511),D=n(512),R=n(513),F=n(514),M=n(525),X=n(516),q=n(517),K=n(529),H=n(515),Q=n(476),V=n(519),Y=n(520),Z=n(65);Z.a.initializeApp({apiKey:"AIzaSyCXiwOUNsbzKH7sbSAZrqA9f7VOeCMdUOQ",authDomain:"gigaturnip-b6b5b.firebaseapp.com",projectId:"gigaturnip-b6b5b",storageBucket:"gigaturnip-b6b5b.appspot.com",messagingSenderId:"414429242328",appId:"1:414429242328:web:a4685f5ac6895ea767c8ad",measurementId:"G-Y8JTEJMTET"});var $=new Z.a.auth.GoogleAuthProvider;Z.a.firestore().settings({ignoreUndefinedProperties:!0});var ee=function(){return $.setCustomParameters({prompt:"select_account"}),Z.a.auth().signInWithPopup($)},te=function(){return Z.a.auth().signOut().then((function(){return localStorage.removeItem("token")})).then((function(){return window.location.reload(!1)}))},ne=Z.a,ae=c.a.createContext(),ce=function(e){var t=e.children,n=Object(a.useState)(null),c=Object(j.a)(n,2),i=c[0],r=c[1];return Object(a.useEffect)((function(){ne.auth().onAuthStateChanged((function(e){e&&(r(e),e.getIdToken(!0).then((function(e){localStorage.setItem("token",e)})))})),ne.auth().onIdTokenChanged((function(e){e&&e.getIdToken(!1).then((function(e){localStorage.setItem("token",e)}))}))}),[]),Object(m.jsx)(ae.Provider,{value:{currentUser:i},children:t})},ie="GigaTurnip Tasks",re=240,se=Object(I.a)((function(e){return Object(N.a)({root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:re,width:"calc(100% - ".concat(re,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:re,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:re,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(k.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},e.breakpoints.up("sm"),{width:e.spacing(9)+1}),toolbar:Object(C.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),content:{flexGrow:1},title:{flexGrow:1},formControl:{margin:e.spacing(1),alignItems:"center"},selectEmpty:{marginTop:e.spacing(2)},select:{},selectIcon:{fill:"white",top:"calc(50% - 14px)"}})})),oe=function(e){var t,n,c=se(),i=Object(B.a)(),r=Object(u.f)(),s=Object(u.g)().campaignId,o=Object(a.useContext)(ae).currentUser,l=e.children,d=Object(a.useState)(!1),b=Object(j.a)(d,2),p=b[0],O=b[1],x=Object(a.useState)(s),f=Object(j.a)(x,2),S=f[0],C=f[1],I=Object(a.useState)([]),N=Object(j.a)(I,2),T=N[0],P=N[1];console.log("CURRENT CAMPAIGN",s),Object(a.useEffect)((function(){g.get(h).then((function(e){return e.data})).then((function(e){console.log(e),P(e)}))}),[]);return Object(m.jsxs)("div",{className:c.root,children:[Object(m.jsx)(L.a,{}),Object(m.jsx)(W.a,{position:"fixed",className:Object(y.a)(c.appBar,Object(k.a)({},c.appBarShift,p)),children:Object(m.jsxs)(D.a,{children:[Object(m.jsx)(R.a,{color:"inherit","aria-label":"open drawer",onClick:function(){O(!0)},edge:"start",className:Object(y.a)(c.menuButton,Object(k.a)({},c.hide,p)),children:Object(m.jsx)(J.a,{})}),Object(m.jsx)(w.a,{variant:"h6",noWrap:!0,style:{cursor:"pointer"},onClick:function(){r.push("/")},children:ie}),Object(m.jsx)(v.a,{className:c.title}),Object(m.jsx)(F.a,{className:c.formControl,size:"small",children:Object(m.jsx)(M.a,{className:c.select,autoWidth:!0,labelId:"campaign-select-label",id:"campaign-select-label",value:S,onChange:function(e){var t=e.target.value;console.log(t),C(t),r.push("/campaign/".concat(t))},label:"Campaign",disableUnderline:!0,style:{color:"white"},inputProps:{classes:{icon:c.selectIcon}},children:T.map((function(e){return Object(m.jsx)(X.a,{value:e.id,children:e.name},"".concat(e.name,"_").concat(e.id))}))})}),o?Object(m.jsx)(q.a,{onClick:te,color:"inherit",children:"Log out"}):Object(m.jsx)(q.a,{onClick:ee,color:"inherit",children:"Login"})]})}),Object(m.jsxs)(K.a,{variant:"permanent",className:Object(y.a)(c.drawer,(t={},Object(k.a)(t,c.drawerOpen,p),Object(k.a)(t,c.drawerClose,!p),t)),classes:{paper:Object(y.a)((n={},Object(k.a)(n,c.drawerOpen,p),Object(k.a)(n,c.drawerClose,!p),n))},children:[Object(m.jsx)("div",{className:c.toolbar,children:Object(m.jsx)(R.a,{onClick:function(){O(!1)},children:"rtl"===i.direction?Object(m.jsx)(E.a,{}):Object(m.jsx)(z.a,{})})}),Object(m.jsx)(_.a,{}),Object(m.jsx)(H.a,{children:Object(m.jsxs)(Q.a,{button:!0,onClick:function(){return e="chain",void r.push("/campaign/".concat(s,"/").concat(e));var e},children:[Object(m.jsx)(V.a,{children:Object(m.jsx)(A.a,{})}),Object(m.jsx)(Y.a,{primary:"Chains"})]})})]}),Object(m.jsxs)("main",{className:c.content,children:[Object(m.jsx)("div",{className:c.toolbar}),l]})]})},le=n(60),je=240,de=Object(I.a)((function(e){return Object(N.a)({root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:je,width:"calc(100% - ".concat(je,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:je,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:je,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(k.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},e.breakpoints.up("sm"),{width:e.spacing(9)+1}),toolbar:Object(C.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),content:{flexGrow:1},title:{flexGrow:1}})})),ue=function(e){var t=de(),n=(Object(B.a)(),c.a.useState(!1)),i=Object(j.a)(n,2),r=i[0],s=(i[1],e.children),o=Object(a.useContext)(ae).currentUser;Object(u.f)();return Object(m.jsxs)("div",{className:t.root,children:[Object(m.jsx)(L.a,{}),Object(m.jsx)(W.a,{position:"fixed",className:Object(y.a)(t.appBar,Object(k.a)({},t.appBarShift,r)),children:Object(m.jsxs)(D.a,{children:[Object(m.jsx)(w.a,{className:t.title,variant:"h6",noWrap:!0,children:ie}),o?Object(m.jsx)(q.a,{onClick:te,color:"inherit",children:"Log out"}):Object(m.jsx)(q.a,{onClick:ee,color:"inherit",children:"Login"})]})}),Object(m.jsxs)("main",{className:t.content,children:[Object(m.jsx)("div",{className:t.toolbar}),s]})]})},be=n(521),he=n(523),pe=n(522),Oe=Object(I.a)({root:{width:300},extra:{marginBottom:15}}),ge=function(e){var t=Oe(),n=e.chain,a=n.id,c=n.name,i=n.description,r=Object(u.f)();return Object(m.jsxs)(be.a,{className:t.root,children:[Object(m.jsxs)(pe.a,{children:[Object(m.jsx)(w.a,{variant:"h5",component:"h2",gutterBottom:!0,children:c}),Object(m.jsxs)(w.a,{className:t.extra,variant:"subtitle2",color:"textSecondary",children:["ID: ",a]}),Object(m.jsx)(w.a,{variant:"body1",component:"p",children:i||Object(m.jsx)("br",{})})]}),Object(m.jsx)(he.a,{children:Object(m.jsx)(q.a,{size:"small",onClick:function(){r.push("/campaign/".concat(a,"/tasks"))},children:"Open"})})]})},me=function(){var e=Object(a.useState)([]),t=Object(j.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){g.get(h).then((function(e){return e.data})).then((function(e){console.log(e),c(e)}))}),[]),Object(m.jsx)(v.a,{container:!0,justify:"center",children:n.map((function(e){return Object(m.jsx)(v.a,{item:!0,style:{padding:10},children:Object(m.jsx)(ge,{chain:e},e.id)})}))})},xe=n(6),fe=n(526),ve=["children","value","index"],we=function(e){var t=e.children,n=e.value,a=e.index,c=Object(xe.a)(e,ve);return Object(m.jsx)("div",Object(C.a)(Object(C.a)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},c),{},{children:n===a&&Object(m.jsx)(fe.a,{p:3,children:Object(m.jsx)(w.a,{children:t})})}))},Se=n(527),Ce=n(524);function ke(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var ye=Object(I.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper}}})),Ie=function(e){var t=ye(),n=e.value,a=e.handleChange;return Object(m.jsxs)(v.a,{children:[Object(m.jsx)("div",{className:t.root,children:Object(m.jsxs)(Se.a,{value:n,onChange:a,variant:"fullWidth",centered:!0,"aria-label":"simple tabs example",children:[Object(m.jsx)(Ce.a,Object(C.a)({label:"\u041d\u0435\u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435"},ke(0))),Object(m.jsx)(Ce.a,Object(C.a)({label:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435"},ke(1)))]})}),e.children]})},Ne=Object(I.a)({root:{width:300},extra:{marginBottom:15}}),Be=function(e){var t=Ne(),n=e.id,a=(e.complete,e.name),c=e.description,i=e.creatable,r=Object(u.f)();return Object(m.jsxs)(be.a,{className:t.root,children:[Object(m.jsxs)(pe.a,{children:[Object(m.jsx)(w.a,{variant:"h5",component:"h2",gutterBottom:!0,children:a}),Object(m.jsx)(w.a,{variant:"body1",component:"p",children:c||Object(m.jsx)("br",{})})]}),Object(m.jsx)(he.a,{children:i?Object(m.jsx)(q.a,{size:"small",onClick:function(){var e={stage:n};g.post(p,e).then((function(e){return e.data})).then((function(e){return r.push("".concat(r.location.pathname,"/").concat(e.id))}))},children:"Create"}):Object(m.jsx)(q.a,{size:"small",onClick:function(){r.push("".concat(r.location.pathname,"/").concat(n))},children:"Open"})})]})},_e=function(e){e.stage;var t=e.assignee,n=e.complete,c=e.username,i=Object(a.useState)([]),r=Object(j.a)(i,2),s=r[0],o=r[1];return Object(a.useEffect)((function(){console.log("stage=&assignee=".concat(t,"&complete=").concat(n,"&assignee__username=").concat(c)),g.get("".concat(p,"?stage=&assignee=&complete=").concat(n,"&assignee__username=").concat(c)).then((function(e){return e.data})).then((function(e){return o(e)}))}),[]),Object(m.jsx)(v.a,{container:!0,direction:"column",alignItems:"center",justify:"center",children:s.map((function(e){return Object(m.jsx)(v.a,{item:!0,style:{padding:12},children:Object(m.jsx)(Be,{id:e.id,name:e.stage.name,description:e.stage.description,complete:e.complete})},e.id)}))})},Te=function(e){e.stage,e.assignee,e.complete,e.username;var t=Object(a.useState)([]),n=Object(j.a)(t,2),c=n[0],i=n[1];return Object(a.useEffect)((function(){g.get("api/v1/taskstages/user_relevant/").then((function(e){return e.data})).then((function(e){i(e),console.log(e)}))}),[]),Object(m.jsx)(v.a,{container:!0,children:c.map((function(e){return Object(m.jsx)(v.a,{item:!0,style:{padding:12},children:Object(m.jsx)(Be,{id:e.id,name:e.name,description:e.description,complete:!1,creatable:!0})},e.id)}))})},ze=function(e){var t=Object(a.useContext)(ae).currentUser,n=Object(a.useState)(0),c=Object(j.a)(n,2),i=c[0],r=c[1];return t&&t.uid&&Object(m.jsxs)(v.a,{children:[Object(m.jsx)(Te,{username:t.uid,complete:!1}),Object(m.jsxs)(Ie,{value:i,handleChange:function(e,t){r(t)},children:[Object(m.jsx)(we,{value:i,index:0,children:Object(m.jsx)(_e,{username:t.uid,complete:!1})}),Object(m.jsx)(we,{value:i,index:1,children:Object(m.jsx)(_e,{username:t.uid,complete:!0})})]})]})},Pe=function(){Object(a.useContext)(ae).currentUser;return Object(m.jsx)("div",{children:Object(m.jsx)(le.a,{children:Object(m.jsxs)(u.c,{children:[Object(m.jsx)(u.a,{path:"/campaign/:campaignId",children:Object(m.jsxs)(oe,{children:[Object(m.jsx)(u.a,{exact:!0,path:"/campaign/:campaignId/tasks",children:Object(m.jsx)(ze,{})}),Object(m.jsx)(u.a,{exact:!0,path:"/campaign/:campaignId/tasks/:id",children:Object(m.jsx)(S,{})})]})}),Object(m.jsx)(u.a,{path:"/",children:Object(m.jsx)(ue,{children:Object(m.jsx)(me,{})})})]})})})},Ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,533)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),i(e),r(e)}))};r.a.render(Object(m.jsx)(ce,{children:Object(m.jsx)(Pe,{})}),document.getElementById("root")),Ee()}},[[473,1,2]]]);
//# sourceMappingURL=main.5adf33f8.chunk.js.map